<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.png"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v3.0.11"><title></title><script async defer data-domain="rasulkireev.com" src="https://stats.rasulkireev.com/js/index.js"></script><link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css"><link rel="stylesheet" href="/_astro/_...slug_.d31f937d.css" /></head><body><footer class="flex flex-col max-w-4xl min-h-screen px-6 mx-auto leading-relaxed bg-white light-mode"><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var b=Object.defineProperty;var f=(a,s,i)=>s in a?b(a,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[s]=i;var d=(a,s,i)=>(f(a,typeof s!="symbol"?s+"":s,i),i);var u;{let a={0:t=>m(t),1:t=>i(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(i(t)),5:t=>new Set(i(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},s=t=>{let[e,r]=t;return e in a?a[e](r):void 0},i=t=>t.map(s),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,r])=>[e,s(r)]));customElements.get("astro-island")||customElements.define("astro-island",(u=class extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var l;if(!this.hydrator||!this.isConnected)return;let e=(l=this.parentElement)==null?void 0:l.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let r=this.querySelectorAll("astro-slot"),c={},h=this.querySelectorAll("template[data-astro-template]");for(let n of h){let o=n.closest(this.tagName);o!=null&&o.isSameNode(this)&&(c[n.getAttribute("data-astro-template")||"default"]=n.innerHTML,n.remove())}for(let n of r){let o=n.closest(this.tagName);o!=null&&o.isSameNode(this)&&(c[n.getAttribute("name")||"default"]=n.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(n){let o=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(o+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${o}`,this.getAttribute("props"),n),n}await this.hydrator(this)(this.Component,p,c,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((e,r)=>{r.disconnect(),setTimeout(()=>this.childrenConnectedCallback(),0)}).observe(this,{childList:!0})}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),r=this.getAttribute("client");if(Astro[r]===void 0){window.addEventListener(`astro:${r}`,()=>this.start(),{once:!0});return}Astro[r](async()=>{let c=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),c?import(c):()=>()=>{}]),l=this.getAttribute("component-export")||"default";if(!l.includes("."))this.Component=h[l];else{this.Component=h;for(let n of l.split("."))this.Component=this.Component[n]}return this.hydrator=p,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},d(u,"observedAttributes",["props"]),u))}})();</script><astro-island uid="lWppq" component-url="/_astro/Navbar.e6e8da12.js" component-export="default" renderer-url="/_astro/client.1070f979.js" props="{}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Navbar&quot;,&quot;value&quot;:true}" await-children=""><nav class="z-50 bg-white"><div class="px-4 mx-auto max-w-7xl"><div class="flex justify-between h-20"><div class="flex"><div class="flex items-center flex-shrink-0"><a href="/"><img class="block w-auto h-8 lg:hidden" src="/src/assets/images/logo.png" alt="Rasul Kireev"></a><a href="/"><img class="hidden w-auto h-12 lg:block" src="/src/assets/images/logo.png" alt="Rasul Kireev"></a></div></div><div class="flex items-center"><div class="hidden sm:ml-6 sm:flex sm:space-x-8"><a href="/" class="inline-flex items-center px-1 pt-1 text-lg font-medium text-gray-500 hover:text-gray-700"> Home </a><a href="/about/" class="inline-flex items-center px-1 pt-1 text-lg font-medium text-gray-500 hover:text-gray-700"> About </a><a href="/projects/" class="inline-flex items-center px-1 pt-1 text-lg font-medium text-gray-500 hover:text-gray-700"> Projects </a><div class="relative inline-block text-left"><div><button type="button" class="inline-flex items-center px-1 pt-1 text-lg font-medium text-gray-500 hover:text-gray-700" id="options-menu" aria-haspopup="true" aria-expanded="true"> Writings <svg class="w-5 h-5 ml-2 -mr-1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div style="display:none;" class="absolute right-0 w-56 mt-2 origin-top-right bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5"><div class="py-1" role="menu" aria-orientation="vertical" aria-labelledby="options-menu"><a href="/articles/" class="block px-4 py-2 text-lg text-gray-700 hover:bg-gray-100 hover:text-gray-900">Articles</a><a href="/tutorials/" class="block px-4 py-2 text-lg text-gray-700 hover:bg-gray-100 hover:text-gray-900">Tutorials</a><a href="/book-notes/" class="block px-4 py-2 text-lg text-gray-700 hover:bg-gray-100 hover:text-gray-900">Book Notes</a><a href="/newsletter/" class="block px-4 py-2 text-lg text-gray-700 hover:bg-gray-100 hover:text-gray-900">Newsletter</a><a href="/now/" class="block px-4 py-2 text-lg text-gray-700 hover:bg-gray-100 hover:text-gray-900">Now</a></div></div></div></div><div class="flex items-center -mr-2 sm:hidden"><button class="inline-flex items-center justify-center p-2 text-gray-400 rounded-md hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="block w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg><svg class="hidden w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div></div></div><div class="hidden"><div class="pt-2 pb-3 space-y-1"><a href="/" class="block py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300">Home</a><a href="/about/" class="block py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300">About</a><a href="/articles/" class="block py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300">Articles</a><a href="/book-notes/" class="block py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300">Book Notes</a><a href="/tutorials/" class="block py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300">Tutorials</a><a href="/newsletter/" class="block py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300">Newsletter</a><a href="/now/" class="block py-2 pl-3 pr-4 text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300">Now</a></div></div></nav></astro-island><p class="mb-10 text-blue-700">
← <a href="/tutorials">back to tutorials</a></p><article class="mb-6 prose lg:prose-xl h-entry" itemscope itemtype="http://schema.org/Article"><h1>Analyzing FIFA 19 data (I). Data Cleaning with Pandas and Numpy</h1><p>You can find all the code to this project <a href="https://github.com/rasulkireev/fifa19-data-analysis">here</a>. You can review the code in this post in <a href="https://github.com/rasulkireev/fifa19-data-analysis/blob/master/1.0-preparing-data-for-ml.ipynb">1.0-preparing-data-for-ml.ipynb</a>.</p>
<p>Data comes from <a href="https://www.kaggle.com/karangadiya/fifa19">Kaggle FIFA19 Dataset</a>. Thanks to <a href="https://www.kaggle.com/karangadiya">Karan Gadiya</a>.</p>
<p>All the exploratory analysis is done with <a href="https://jupyter.org/">Jupyter Notebook</a>.</p>
<h2 id="goal">Goal</h2>
<p>My goal with this project is to learn/improve essential data science/analysis skills as well as gain a better understanding of FIFA rating and ranking rules. I am using this dataset as a proxy to the real world data to see if it would make sense to spend considerable amount of time and effort to acquire real world data.</p>
<p>The first thing we need to do with a big and messy table of players’ data is to “clean” and make it usable for further analysis.</p>
<h2 id="cleaning">Cleaning</h2>
<p>Let’s start with package import, basic settings and actual data import, that’s pretty standard.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> pandas </span><span style="color: #F97583">as</span><span style="color: #E1E4E8"> pd</span></span>
<span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> numpy </span><span style="color: #F97583">as</span><span style="color: #E1E4E8"> np</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D"># Display all floats with 2 decimals</span></span>
<span class="line"><span style="color: #E1E4E8">pd.options.display.float_format </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">'</span><span style="color: #79B8FF">{</span><span style="color: #F97583">:.2f</span><span style="color: #79B8FF">}</span><span style="color: #9ECBFF">'</span><span style="color: #E1E4E8">.format</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">df </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> pd.read_csv(</span><span style="color: #9ECBFF">'data.csv'</span><span style="color: #E1E4E8">, </span><span style="color: #FFAB70">index_col</span><span style="color: #F97583">=</span><span style="color: #79B8FF">0</span><span style="color: #E1E4E8">)</span></span></code></pre>
<p>The reason I added <code>index_col=0</code> is because the dataset already had an index column, no need to create another one.</p>
<h3 id="exploring">Exploring</h3>
<p>Run <code>df.sample(5)</code> to view 5 random rows from the dataset to get the feel for how it look and what might be wrong with it. Additionally, we want to run <code>df.info()</code> to see what types of data we are working with as well as counts, which are useful for spotting any columns with missing values.</p>
<h4 id="positions">Positions</h4>
<p>I see that there are Postitions that are not necesssary for my application. For example, I don’t need LS (‘Left Striker’), since it is almost the same as ST (“Striker”). Grouping players in similar Positions will increase number of dat points, which hypothetically should make the results more <a href="https://towardsdatascience.com/a-very-friendly-introduction-to-confidence-intervals-9add126e714">confident</a>.
Run <code>df.Position.unique()</code>to see all positions.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'Position'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">'Position'</span><span style="color: #E1E4E8">].map({</span><span style="color: #9ECBFF">'GK'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'GK'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'CAM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CAM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'CB'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CB'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'CDM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CDM'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">                                      </span><span style="color: #9ECBFF">'CM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LB'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'LB'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'LM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LW'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'LW'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">                                      </span><span style="color: #9ECBFF">'RB'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'RB'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'RM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RW'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'RW'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'ST'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'ST'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">                                      </span><span style="color: #9ECBFF">'CF'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'ST'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LAM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CAM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LCB'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CB'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LCM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CM'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">                                      </span><span style="color: #9ECBFF">'LDM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CDM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LF'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'LW'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LS'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'ST'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'LWB'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'LB'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">                                      </span><span style="color: #9ECBFF">'RAM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CAM'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'RCB'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CB'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RCM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CM'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'RDM'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'CDM'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">                                      </span><span style="color: #9ECBFF">'RF'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'RW'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'RS'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'ST'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RWB'</span><span style="color: #E1E4E8">: </span><span style="color: #9ECBFF">'RB'</span><span style="color: #E1E4E8">})</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D"># Remove rows with Position = NaN</span></span>
<span class="line"><span style="color: #E1E4E8">df.dropna(</span><span style="color: #FFAB70">subset</span><span style="color: #F97583">=</span><span style="color: #E1E4E8">[</span><span style="color: #9ECBFF">'Position'</span><span style="color: #E1E4E8">], </span><span style="color: #FFAB70">inplace</span><span style="color: #F97583">=</span><span style="color: #79B8FF">True</span><span style="color: #E1E4E8">)</span></span></code></pre>
<p>Code above will map existing positions to the ones we want. (i.e. LF -> LW)
<em>Note: we also need to map “good” positions.</em></p>
<h4 id="value-wage--release-clause">Value, Wage &#x26; Release Clause</h4>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #6A737D"># Function that turn a string variable "€100M" to 100,000,000</span></span>
<span class="line"><span style="color: #F97583">def</span><span style="color: #E1E4E8"> </span><span style="color: #B392F0">money_string_replace</span><span style="color: #E1E4E8">(variable_name):</span></span>
<span class="line"><span style="color: #E1E4E8">    df[variable_name] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> (df[variable_name].str[</span><span style="color: #79B8FF">1</span><span style="color: #E1E4E8">:].replace(</span><span style="color: #F97583">r</span><span style="color: #9ECBFF">'</span><span style="color: #79B8FF">[KM]</span><span style="color: #F97583">+</span><span style="color: #79B8FF">$</span><span style="color: #9ECBFF">'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">''</span><span style="color: #E1E4E8">, </span><span style="color: #FFAB70">regex</span><span style="color: #F97583">=</span><span style="color: #79B8FF">True</span><span style="color: #E1E4E8">).astype(</span><span style="color: #79B8FF">float</span><span style="color: #E1E4E8">) </span><span style="color: #F97583">*</span></span>
<span class="line"><span style="color: #E1E4E8">                 df[variable_name].str.extract(</span><span style="color: #F97583">r</span><span style="color: #9ECBFF">'</span><span style="color: #79B8FF">[\d</span><span style="color: #85E89D; font-weight: bold">\.</span><span style="color: #79B8FF">]</span><span style="color: #F97583">+</span><span style="color: #79B8FF">([KM]</span><span style="color: #F97583">+</span><span style="color: #79B8FF">)</span><span style="color: #9ECBFF">'</span><span style="color: #E1E4E8">, </span><span style="color: #FFAB70">expand</span><span style="color: #F97583">=</span><span style="color: #79B8FF">False</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #E1E4E8">                 .fillna(</span><span style="color: #79B8FF">1</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #E1E4E8">                 .replace([</span><span style="color: #9ECBFF">'K'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'M'</span><span style="color: #E1E4E8">], [</span><span style="color: #79B8FF">10</span><span style="color: #F97583">**</span><span style="color: #79B8FF">3</span><span style="color: #E1E4E8">, </span><span style="color: #79B8FF">10</span><span style="color: #F97583">**</span><span style="color: #79B8FF">6</span><span style="color: #E1E4E8">]).astype(</span><span style="color: #79B8FF">int</span><span style="color: #E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">money_string_replace(</span><span style="color: #9ECBFF">'Value'</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #E1E4E8">money_string_replace(</span><span style="color: #9ECBFF">'Wage'</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #E1E4E8">money_string_replace(</span><span style="color: #9ECBFF">'Release Clause'</span><span style="color: #E1E4E8">)</span></span></code></pre>
<h4 id="preferred-foot">Preferred Foot</h4>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #6A737D"># Creating a dummy variable to identify if a player is left footed or not</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Preferred Foot'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Left"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Preferred Foot = Left'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">1</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Preferred Foot'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Right"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Preferred Foot = Left'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">0</span></span></code></pre>
<h4 id="work-rates">Work Rates</h4>
<p>Current work rates are in the format of “High/Low”, where the first word refers to Attacking Work Rate and the second refers to Defensive Work Rate. I want to split the value into two values and create column for each attacking work rate and defensive work rate.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #6A737D"># Splitting the work rate column into attacking and defensive rates.</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'Work Rates'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">'Work Rate'</span><span style="color: #E1E4E8">].str.split(</span><span style="color: #9ECBFF">'/'</span><span style="color: #E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D"># Allocating each list item into the according work type</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'Attacking Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">'Work Rates'</span><span style="color: #E1E4E8">].str.get(</span><span style="color: #79B8FF">0</span><span style="color: #E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D"># Removing any whitespace</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'Attacking Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">'Attacking Rate'</span><span style="color: #E1E4E8">].str.strip()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D"># Creating a numeric variable for each work type</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Attacking Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Low"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Attacking Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">1</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Attacking Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Medium"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Attacking Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">2</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Attacking Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"High"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Attacking Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">3</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'Defensive Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">'Work Rates'</span><span style="color: #E1E4E8">].str.get(</span><span style="color: #79B8FF">1</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'Defensive Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">'Defensive Rate'</span><span style="color: #E1E4E8">].str.strip()</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Defensive Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Low"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Defensive Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">1</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Defensive Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Medium"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Defensive Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">2</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Defensive Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"High"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Defensive Rate'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">3</span></span></code></pre>
<h4 id="height-and-weight">Height and Weight</h4>
<p>Kilograms and Centimeteres are a little more intuitive for me and slightly easier to use, so I am going to convert values.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #6A737D"># Converting pounds to kg</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">"Weight"</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">"Weight"</span><span style="color: #E1E4E8">].str[:</span><span style="color: #79B8FF">3</span><span style="color: #E1E4E8">].astype(</span><span style="color: #79B8FF">float</span><span style="color: #E1E4E8">) </span><span style="color: #F97583">/</span><span style="color: #79B8FF">2.205</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">## Converting Feet and Inches string to a CM value</span></span>
<span class="line"><span style="color: #6A737D"># Splitting Feet from Inches</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'HeightCM'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">'Height'</span><span style="color: #E1E4E8">].str.split(</span><span style="color: #9ECBFF">"'"</span><span style="color: #E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D"># Further split of feet and inches</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'feet'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">'HeightCM'</span><span style="color: #E1E4E8">].str.get(</span><span style="color: #79B8FF">0</span><span style="color: #E1E4E8">).astype(</span><span style="color: #79B8FF">float</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'inch'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> df[</span><span style="color: #9ECBFF">'HeightCM'</span><span style="color: #E1E4E8">].str.get(</span><span style="color: #79B8FF">1</span><span style="color: #E1E4E8">).astype(</span><span style="color: #79B8FF">float</span><span style="color: #E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D"># Replcaing Old string with new CM value</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'Height'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> (df[</span><span style="color: #9ECBFF">'feet'</span><span style="color: #E1E4E8">]</span><span style="color: #F97583">*</span><span style="color: #79B8FF">12</span><span style="color: #F97583">+</span><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'inch'</span><span style="color: #E1E4E8">])</span><span style="color: #F97583">*</span><span style="color: #79B8FF">2.54</span></span></code></pre>
<h4 id="body-type">Body Type</h4>
<p>There are generally 3 body type: Lean, Normal and Stocky. There are exceptions, however. More specifically, several players have bosy type of their own, for example Messi, Cristiano Ronaldo and Akinfenwa. Those are outliers and I have decided to use my own judgement when assigning new values to them. Since ther was a row with Body Weight of an unknown type we will simply remove it from data, that shouldn’t affect results.
twitterLink: ""
hnLink: ""
redditLink: ""
indiehackersLink: ""</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Lean"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">1</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Normal"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">2</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Stocky"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">3</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Messi"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">2</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"C. Ronaldo"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">2</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Neymar"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">1</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Courtois"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">2</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Shaqiri"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">3</span></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"Akinfenwa"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">3</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">df.loc[df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">==</span><span style="color: #E1E4E8"> </span><span style="color: #9ECBFF">"PLAYER_BODY_TYPE_25"</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">] </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> np.nan</span></span>
<span class="line"><span style="color: #E1E4E8">df.dropna(</span><span style="color: #FFAB70">subset</span><span style="color: #F97583">=</span><span style="color: #E1E4E8">[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">], </span><span style="color: #FFAB70">inplace</span><span style="color: #F97583">=</span><span style="color: #79B8FF">True</span><span style="color: #E1E4E8">)</span></span>
<span class="line"><span style="color: #E1E4E8">df[</span><span style="color: #9ECBFF">'Body Type'</span><span style="color: #E1E4E8">].astype(</span><span style="color: #9ECBFF">'int64'</span><span style="color: #E1E4E8">)</span></span></code></pre>
<h4 id="droping-unnecessary-columns">Droping unnecessary columns</h4>
<p>Now for the final step, let’s remove the unnecessary columns, anything non-integer, except for the position column which we will certainly need.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #6A737D"># Dropping unneccesary columns</span></span>
<span class="line"><span style="color: #E1E4E8">df.drop([</span><span style="color: #9ECBFF">"Name"</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">"Nationality"</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'Club'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'Joined'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'Contract Valid Until'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'Release Clause'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #9ECBFF">"Photo"</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">"Flag"</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">"Club Logo"</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">"Special"</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">"ID"</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'Preferred Foot'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'Real Face'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #9ECBFF">'Jersey Number'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'Loaned From'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LS'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'ST'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RS'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LW'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LF'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'CF'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #9ECBFF">'RF'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RW'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LAM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'CAM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RAM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LM'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'LB'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LCB'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'CB'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RCB'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #9ECBFF">'RB'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LCM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'CM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RCM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LWB'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'LDM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'CDM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RDM'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'RWB'</span><span style="color: #E1E4E8">,</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #9ECBFF">'Work Rate'</span><span style="color: #E1E4E8">,</span><span style="color: #9ECBFF">'Work Rates'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'HeightCM'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'feet'</span><span style="color: #E1E4E8">, </span><span style="color: #9ECBFF">'inch'</span><span style="color: #E1E4E8">],</span></span>
<span class="line"><span style="color: #E1E4E8">        </span><span style="color: #FFAB70">axis</span><span style="color: #F97583">=</span><span style="color: #79B8FF">1</span><span style="color: #E1E4E8">, </span><span style="color: #FFAB70">inplace</span><span style="color: #F97583">=</span><span style="color: #79B8FF">True</span><span style="color: #E1E4E8">)</span></span></code></pre>
<h2 id="export-to-csv">Export to CSV</h2>
<p>Let’s make varibale names lower case so it is a little easier to work with in the future.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #E1E4E8">df.columns </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> </span><span style="color: #79B8FF">map</span><span style="color: #E1E4E8">(</span><span style="color: #79B8FF">str</span><span style="color: #E1E4E8">.lower, df.columns)</span></span></code></pre>
<p>Finally, run the following code to export this dataset to csv. We are going to use it in the next part:</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #E1E4E8">df.to_csv(</span><span style="color: #9ECBFF">'data/processed/reduced_clean_data.csv'</span><span style="color: #E1E4E8">)</span><span style="color: #FDAEB7; font-style: italic">`</span></span></code></pre></article><footer class="flex flex-col items-center justify-between w-full h-16 md:flex-row md:h-20 pin-b"><div class="flex flex-row"><a class="flex items-center pr-2 m-0 font-normal leading-tight text-center text-gray-600 border-0" href="/rss.xml">RSS</a></div><div class=""><a class="font-normal text-blue-700 border-0" href="https://xn--sr8hvo.ws/%E2%9E%B0%F0%9F%8D%8A%E2%8F%AD/previous">←</a>
An IndieWeb Webring 🕸💍
<a class="font-normal text-blue-700 border-0" href="https://xn--sr8hvo.ws/%E2%9E%B0%F0%9F%8D%8A%E2%8F%AD/next">→</a></div></footer></footer></body></html>